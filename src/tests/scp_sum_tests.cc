#include "scp_matrix_oop_tests.h"

TEST(SumMatrix, 0) {
  SCPMatrix m1({1, 1, 3357.09085222302});
  SCPMatrix m2({1, 1, -9.623990419208303});
  SCPMatrix m1_res({1, 1, 3347.4668618038118});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 1) {
  SCPMatrix m1({2, 2, -969.9898620170793, 2865147076.100971, 1891.2700137689776,
                0.9306220789776865});
  SCPMatrix m2({5,
                6,
                31799261.584055103,
                90.71556499532221,
                11347230.572465528,
                347.74439786529064,
                -48.498651488392966,
                -583361322.9828827,
                58.11704426373826,
                7264504241.004318,
                -0.3888581986785917,
                -4626.657525086542,
                -2443103091.8857965,
                0.526960722198092,
                98682614.15893432,
                1761.1951030248774,
                -3308.444489422968,
                617171586.61016,
                -4381698295.534198,
                9068141073.05734,
                974.0748693329924,
                27844.229497409513,
                412739.84541114204,
                7.478870569040658,
                -0.4201337273729179,
                167931529.00615647,
                560182.5839462441,
                7.351682127849525,
                1541273.1751500496,
                -1576373780.2326417,
                16990166.678246375,
                9.585935482047939});

  EXPECT_THROW(m1.SumMatrix(m2), std::invalid_argument);
}

TEST(SumMatrix, 2) {
  SCPMatrix m1({5,
                5,
                93509816.04698424,
                -38295.98179615016,
                -2547898.587218811,
                8232173.0743125705,
                38263.50912683603,
                96276.90286696581,
                1928353049.391771,
                0.1771063370171877,
                2.9372182561825735,
                -40288674.59174367,
                7213.803783676489,
                525330.6071113413,
                3791182999.9317594,
                -456.99040240896295,
                825740709.2187289,
                278260.23535454314,
                -6568.644847122925,
                58.59372057882257,
                4521.1043896739675,
                90682.51782221119,
                87.10962636059718,
                -0.7043448737047764,
                -0.38599630430936127,
                6496545.903435918,
                0.3634628963977772});
  SCPMatrix m2({5,
                5,
                -1091848.906294437,
                349661938.97108656,
                -174.92961454166544,
                -1.937447625607559,
                -70.4863491697072,
                -2420785516.831543,
                470.5801261767423,
                -0.45431114534810046,
                -1582106.8182227537,
                -992362436.8972903,
                -217698.22945748142,
                -23585.074324028312,
                -6046.859356493406,
                -50342092.017644525,
                251559.0206820182,
                -67.86162423646091,
                -202627259.76797414,
                -343625.62588267564,
                -0.7089777605777345,
                -86771.52320086944,
                441708439.50216585,
                -5735.441396637338,
                600.8776321626442,
                193281233.8091432,
                -0.5536695343562689});
  SCPMatrix m1_res({5,
                    5,
                    92417967.1406898,
                    349623642.9892904,
                    -2548073.5168333524,
                    8232171.136864945,
                    38193.022777666316,
                    -2420689239.928676,
                    1928353519.9718974,
                    -0.27720480833091277,
                    -1582103.8810044974,
                    -1032651111.489034,
                    -210484.42567380492,
                    501745.532787313,
                    3791176953.072403,
                    -50342549.00804693,
                    825992268.2394109,
                    278192.3737303067,
                    -202633828.41282126,
                    -343567.0321620968,
                    4520.39541191339,
                    3910.9946213417425,
                    441708526.6117922,
                    -5736.145741511043,
                    600.4916358583348,
                    199777779.7125791,
                    -0.1902066379584917});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 3) {
  SCPMatrix m1({3,
                7,
                38.297001506548135,
                -3077143.7343290863,
                -554.0469253150445,
                31.933735118165853,
                0.3188548135109903,
                8563305903.887687,
                -906.3095423447203,
                -71090902.82879981,
                56479.09096498811,
                0.528720061304057,
                -1201237347.5416815,
                9823152.88267843,
                -0.10907580009205009,
                -2173775991.4704733,
                -79726.61407513368,
                -520596391.5106505,
                49948945.44873433,
                -0.8841943955259489,
                -3564.1824058996717,
                -8032045.853805036,
                -511043.5634900281});
  SCPMatrix m2({3,
                7,
                -0.8031781391558844,
                0.808319122013921,
                -762157068.849154,
                -6340.274639361842,
                -0.7139451876318907,
                -872.5369719667306,
                4282929720.1759887,
                -29298.349878196528,
                -585372.8515151085,
                -1841258.7693840133,
                -165075832.89586246,
                -5261.535971931113,
                13.882987961432057,
                -9.809252607288762,
                -201.55021141607853,
                92924483.373012,
                0.04256913896749137,
                0.7940152451428887,
                -9.558328330318815,
                -8330.121826303486,
                0.4483778189395551});
  SCPMatrix m1_res({3,
                    7,
                    37.49382336739225,
                    -3077142.926009964,
                    -762157622.8960793,
                    -6308.340904243676,
                    -0.3950903741209004,
                    8563305031.350715,
                    4282928813.8664465,
                    -71120201.178678,
                    -528893.7605501204,
                    -1841258.240663952,
                    -1366313180.4375439,
                    9817891.3467065,
                    13.773912161340007,
                    -2173776001.279726,
                    -79928.16428654976,
                    -427671908.1376385,
                    49948945.491303466,
                    -0.09017915038306024,
                    -3573.7407342299907,
                    -8040375.9756313395,
                    -511043.11511220917});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 4) {
  SCPMatrix m1(
      {3, 1, 0.6250049750769409, 0.7395904474184121, 8217977217.624061});
  SCPMatrix m2(
      {3, 1, 1.6021957314329494, 0.7954025192276339, 0.010671361721649064});
  SCPMatrix m1_res(
      {3, 1, 2.2272007065098904, 1.534992966646046, 8217977217.634732});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 5) {
  SCPMatrix m1({3,
                7,
                2863801651.6512566,
                0.43286544304246133,
                -805.159153357708,
                1911731.175744591,
                -8777.775913916885,
                300836.29530182,
                70173.0376717033,
                -0.3609732648009414,
                -1568.6290147541781,
                896685618.0533894,
                60.27886452138315,
                0.018948713450925414,
                -0.023390945084608372,
                -39.68117338479304,
                -617.393067822656,
                0.40830590638286013,
                24013.41717468759,
                972.0426429543031,
                91665.92942149054,
                -486.7251322428512,
                2589788.4658529544});
  SCPMatrix m2({3,
                7,
                2.686567530895758,
                -775554358.7918797,
                -94601.33600821841,
                -85471.85152043664,
                -3603899.5980121777,
                -0.5707701906362183,
                -1047.6846737000367,
                -45.94444738578483,
                888629.998407583,
                -457.31682996443266,
                3425.1562297600944,
                -8151733.798524309,
                -998503.7652696437,
                5061943356.451188,
                -2544971.873262888,
                968779.0607394457,
                -15.299633655510736,
                -0.4694525067657157,
                -387615.5515658142,
                23.615811942058862,
                -15.248387196872793});
  SCPMatrix m1_res({3,
                    7,
                    2863801654.337824,
                    -775554358.3590142,
                    -95406.49516157611,
                    1826259.3242241545,
                    -3612677.3739260947,
                    300835.72453162936,
                    69125.35299800328,
                    -46.305420650585766,
                    887061.3693928288,
                    896685160.7365595,
                    3485.4350942814776,
                    -8151733.779575596,
                    -998503.7886605888,
                    5061943316.770015,
                    -2545589.2663307106,
                    968779.4690453521,
                    23998.11754103208,
                    971.5731904475374,
                    -295949.62214432366,
                    -463.1093203007923,
                    2589773.2174657574});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 6) {
  SCPMatrix m1({6,
                6,
                -33577939.45864919,
                -7724759.3741418915,
                239228.20434160563,
                52588.84934341054,
                -6.032106187254378,
                -0.3989785814248531,
                -5782.624997267301,
                -9.525024672801841,
                -301550980.6599952,
                -0.4390915218356062,
                -0.8207004353690399,
                -58617.98447005974,
                5.7429658849047485,
                457470004.15380025,
                -498792.8625293717,
                23.757314300632437,
                7661657743.91081,
                5754427.217907332,
                -1880.2135981652602,
                -98594372.93306965,
                9791030396.558817,
                -19158478.730074648,
                8562.224431577923,
                0.5809097782747102,
                -71.83680310650958,
                -257778664.15527993,
                -407.3042323796117,
                -8146489646.082261,
                -0.836409437180926,
                764054515.578364,
                414.8414662627935,
                -188.9958120891224,
                71879.08843093862,
                -8238.19006148713,
                -11878976.944537323,
                -5820946.832022768});
  SCPMatrix m2({6,
                6,
                -788.6719328358845,
                3551775880.1914887,
                93.80250482869702,
                -126607.82814455651,
                -7.815078972245782,
                -0.695899310934553,
                -148446441.97119173,
                -5464.933703794577,
                5019.216361071756,
                9.096215171627252,
                9966.275373856037,
                -8758.775531633159,
                -700208.2603665938,
                0.11547959620834658,
                -5685.857669912682,
                -7.636405566166556,
                -62.28747691403795,
                -0.1341744224500938,
                251377.1579649262,
                -30346259.73515638,
                -156164.13942872,
                0.2771943936577592,
                -4750675748.8727865,
                -741976.0672339394,
                0.713296560633657,
                -526145666.51744276,
                2576.9205952407215,
                670.8051622995348,
                8661780186.437479,
                0.6412259086485795,
                3804.6616962099442,
                -5042.599120628342,
                72018921.72548276,
                487861.9324872573,
                -61.09725881267839,
                511505117.81311035});
  SCPMatrix m1_res({6,
                    6,
                    -33578728.13058203,
                    3544051120.817347,
                    239322.00684643432,
                    -74018.97880114598,
                    -13.84718515950016,
                    -1.0948778923594062,
                    -148452224.596189,
                    -5474.458728467379,
                    -301545961.44363415,
                    8.657123649791647,
                    9965.454673420667,
                    -67376.76000169289,
                    -700202.517400709,
                    457470004.26927984,
                    -504478.7201992844,
                    16.120908734465882,
                    7661657681.623334,
                    5754427.0837329095,
                    249496.94436676096,
                    -128940632.66822603,
                    9790874232.419388,
                    -19158478.452880256,
                    -4750667186.648355,
                    -741975.4863241612,
                    -71.12350654587593,
                    -783924330.6727227,
                    2169.61636286111,
                    -8146488975.277099,
                    8661780185.60107,
                    764054516.21959,
                    4219.503162472738,
                    -5231.594932717464,
                    72090800.8139137,
                    479623.74242577015,
                    -11879038.041796135,
                    505684170.98108757});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 7) {
  SCPMatrix m1({3, 4, -609848.6447431121, 6632748.786139828, -701626118.5440103,
                -17.285571785380306, -295.23334803816016, 68381756.29365961,
                238863111.5145371, 6.688560602648876, -5.52668642906276,
                -78.77464768444014, 0.9806432698637457, 4435316.687216687});
  SCPMatrix m2({3, 4, 5435659896.306934, 0.6001174523961113, 989309.4888820841,
                -885822536.3420423, 2622493.9731323994, 0.612674760297649,
                -6035751214.087524, 8877015246.585562, -578.3100496918561,
                3.1981365697551056, -0.7506505820719611, 987706756.3349018});
  SCPMatrix m1_res({3, 4, 5435050047.662191, 6632749.386257281,
                    -700636809.0551282, -885822553.6276141, 2622198.7397843613,
                    68381756.90633437, -5796888102.572988, 8877015253.274122,
                    -583.8367361209189, -75.57651111468503, 0.2299926877917846,
                    992142073.0221184});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 8) {
  SCPMatrix m1({2, 7, 6341.690071248289, -63285196.16255154,
                -0.008870600504454873, 65063.45626149046, 0.6507807136773787,
                94198.98624865056, 4845125.241526957, -1388.381979204949,
                -61.52730193781847, 0.2681282684979258, -21276257.09979365,
                656.8362832674701, 12.937387126356958, -559.1093968885659});
  SCPMatrix m2({2, 7, -1.826115201732268, 368471282.7393339,
                -419.00111109790083, 939.6641776838841, -0.019991955856189625,
                -550119.7277497388, -229.1698480069091, -44038560.60805306,
                -3.901373594807364, -4.255641508938846, 0.0657186307397506,
                783022357.8260207, -4.643143729980748, 0.3725046648753716});
  SCPMatrix m1_res({2, 7, 6339.863956046557, 305186086.5767824,
                    -419.0099816984053, 66003.12043917434, 0.630788757821189,
                    -455920.74150108825, 4844896.0716789495, -44039948.99003226,
                    -65.42867553262583, -3.9875132404409204,
                    -21276257.034075018, 783023014.662304, 8.29424339637621,
                    -558.7368922236906});

  m1.SumMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrix, 9) {
  SCPMatrix m1({6,
                9,
                -4882084.585243211,
                -3319085062.557924,
                22501019.971457236,
                2269984.059824615,
                97891293.12594745,
                37672.27250250545,
                -77.47943837282169,
                89304273.91209558,
                -3669439227.293151,
                96924.27882309788,
                -782.8456644233822,
                0.27296048148063157,
                -0.42215209417172905,
                -0.3730234054441258,
                7181078044.128752,
                -17724.94398614429,
                -98722.3435724824,
                0.08437497578912545,
                -6263.253811373303,
                -519.8679917097645,
                -0.05132459606620121,
                -62.55080089801607,
                -0.3368041729649319,
                64862627.43559975,
                -0.5842054186875492,
                230.77742259607703,
                -3384338905.723845,
                -6.219155289358055,
                4867601152.335931,
                60066388.63711865,
                -447091230.6911848,
                -83.27288186869836,
                -67.2698145095123,
                42335851.26896124,
                -2451323.1733074803,
                61.20948256786255,
                -9237383.401927287,
                -9.25063937436294,
                -0.12832093123254595,
                0.34836729138330735,
                -913747.9540384683,
                -4385.289214427823,
                -3502.668435992996,
                -0.28874863202638124,
                19101002.44717171,
                -41.917287709994845,
                187912270.669788,
                380325.2715021282,
                -1204308.8254489054,
                98550.05953569229,
                74164757.33446579,
                33021.93104687343,
                -0.8749514411276819,
                936116.1981596741});
  SCPMatrix m2({3,
                8,
                -0.1578025108587634,
                -291213.5739038646,
                407812695.076643,
                -0.3216545577627885,
                -168536633.3587457,
                5751.8595300564475,
                -0.26838567416684345,
                301323719.4741877,
                45487.14763732143,
                -100.7834212215214,
                95779.88807979441,
                0.35470905003185427,
                -0.2112115004122591,
                5904097.841938205,
                -0.9139574526417801,
                19.611865892121894,
                139.2340983941278,
                -722936.6962746774,
                8328.447029004097,
                -0.9388743888628953,
                -1727043999.872816,
                896.3018063196382,
                2755236.657824367,
                -16199557.696232226});

  EXPECT_THROW(m1.SumMatrix(m2), std::invalid_argument);
}
