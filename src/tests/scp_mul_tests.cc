#include "scp_matrix_oop_tests.h"

TEST(MulMatrix, 0) {
  SCPMatrix m1({8,
                8,
                -21141.197670544432,
                7106158.197785304,
                -77498.55631244059,
                -3966980.2701521097,
                -0.6094484085303659,
                -565425.8211358452,
                292104819.53057444,
                0.24303554607355315,
                -0.6325543971738186,
                304147478.68156135,
                -6686571450.20162,
                445.3963824000793,
                -986589.8181090673,
                -0.3215873561176307,
                -3003009923.7321997,
                558304353.6248004,
                -153.59767647627564,
                -0.69129424570824,
                449761.5477551056,
                603.0861738329451,
                -0.04825743174112096,
                3.77216236449459,
                20.942381378468845,
                7874.9825130611525,
                21729896.493718892,
                -407.1333353164931,
                0.8560444492557762,
                0.6419761186205093,
                4285593.799783961,
                97.38629087593989,
                1.678040154528082,
                521821446.80708396,
                0.017760373654978956,
                -662.4577505327499,
                -639124569.9598804,
                2441411.1221143054,
                -249.82193995443214,
                16712552.99239095,
                -460.55866472888954,
                -0.5510134211870852,
                -4.967270145190692,
                516939501.3173638,
                2659386861.6989837,
                8285.075027707855,
                -26246.413740549902,
                -61977.750702598576,
                -88886677.54772235,
                -330.4372769908166,
                279215004.5720961,
                0.534365280120336,
                -97067651.24144556,
                17194.032617627454,
                6072672.401196048,
                -47768012.67937631,
                -90859.90833690112,
                75.77822375623352,
                -80255.15146407258,
                2.244520998328227,
                -272548.9469768744,
                -0.17080821066341156,
                8876470.814048966,
                0.01887531540506826,
                230377.1453741882,
                0.4734527769304654});
  SCPMatrix m2({8,
                8,
                4094156.814486407,
                -15.270307019435702,
                -6.371678150651194,
                0.701991643602306,
                37998968.00805557,
                1372.5886975597557,
                -0.7872679311425778,
                -57.41514952952441,
                89997.29701850623,
                96716.0704318533,
                6251.891277833087,
                -5388338.189535826,
                9802274.047459735,
                1.1990903884724102,
                -0.2964000349573719,
                -3763479.046374764,
                970354862.8109837,
                -6365478304.042844,
                -2.853164390691516,
                -6.690768206888035,
                75953655.9126902,
                714778.180530293,
                -917776.4069515148,
                -0.9544755576856377,
                -8354.493646946923,
                -207.4411823523673,
                89240.20868371632,
                394.70873681798355,
                0.4126686959053203,
                252239.49043424177,
                -9558830.250337744,
                -155227.91112320666,
                -1106928.8112339736,
                -126.21490929688406,
                -178.56588648485095,
                62079988.99779875,
                -0.309033311042214,
                -56752825.667910345,
                0.4757370030123107,
                7055809.2377804,
                -4018.1324120676154,
                -8897729.419433013,
                -0.5438908833861074,
                -74094.83514211027,
                -688702.9805639726,
                0.35668928562985114,
                -59502.92046129589,
                73.96696236579301,
                0.24796958516737821,
                -803.0360055007122,
                6970.762707374817,
                -0.3390760914641743,
                -92093.50141213935,
                2.0327348589255303,
                -124.48909096546146,
                7911483975.996734,
                -94.51807183143062,
                519208996.7416931,
                -99993119.68062381,
                -4.388164424640884,
                0.40645135148464384,
                9929550658.512924,
                0.7578663174842933,
                523.4854474309402});
  SCPMatrix m1_res({8,
                    8,
                    -74612634152143.23,
                    498800043198233.44,
                    1726582525508.6152,
                    -38250190643407.04,
                    36455320906797.9,
                    -1053002464569.9438,
                    37988095889969.31,
                    2.3109564708913055E+18,
                    -6.488318711221378E+18,
                    4.285313396561411E+19,
                    -55845606529028960.0,
                    -1700053652867576.0,
                    -5.0461165232528557E+17,
                    5.538987932943285E+18,
                    6137147437418295.0,
                    -2.375941620664181E+19,
                    436427670309830.6,
                    -2858858646227999.5,
                    -787391389971.2537,
                    -2356269.921710533,
                    34155185988393.09,
                    78516672189232.45,
                    -418545556618.1144,
                    165597662314.3424,
                    84173228629944.88,
                    2.7093438264724976E+17,
                    -52178555288690210.0,
                    266049527912044.53,
                    825709859416237.8,
                    5.181209301038628E+18,
                    367685408.0850326,
                    30525058563314.605,
                    -6.201777217355649E+17,
                    4.0681848790296873E+18,
                    219734265780.77783,
                    -1245013374851.0327,
                    -48555364106633050.0,
                    -456207764205937.2,
                    562241971270633.9,
                    -4020100989507.2207,
                    2.5805955256934723E+18,
                    -1.6928218922568202E+19,
                    2638439490990.862,
                    -2787087401403060.0,
                    2.070655656709698E+17,
                    1899082695761767.2,
                    -2440787114204721.0,
                    -7.051712050986856E+17,
                    -93053447611572720.0,
                    6.18307089237568E+17,
                    -9236771180.160898,
                    380531648279556.2,
                    3270145387141861.0,
                    -412883146404060.75,
                    91764175990641.72,
                    -676011233584056.9,
                    -274623394254001.75,
                    1734903350522547.2,
                    -25184709.872516297,
                    551051200068843.3,
                    -23771898863689.953,
                    -503955021255207.94,
                    250116231484.62555,
                    1885255775279973.2});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 1) {
  SCPMatrix m1({8,
                8,
                0.9762283643092161,
                -3.4967825869183358,
                4301198.220480672,
                644167.0600984773,
                54077095.03713224,
                223854763.7245324,
                -7250522056.091874,
                0.35446150026478884,
                96080.88523103534,
                88311.46295701126,
                53337.819834374444,
                14456423.326548718,
                -844187277.7733972,
                0.2641895490329892,
                -7414.38759973193,
                -0.22958221293021164,
                -12103.10472169005,
                2162583767.1356497,
                -94.38699607348055,
                52.884653229554054,
                -922.591163299281,
                -7002550.035419545,
                -651862.314296592,
                72097.36992426935,
                19.940762049906446,
                -76.05689391108942,
                -155579981.33654216,
                -8539437.226695918,
                -0.7866762169056134,
                -0.27094568518315787,
                -8.01200896733788,
                -37412814.60836962,
                -82.06899370898748,
                647352214.712166,
                386896099.67717475,
                88.82575778496866,
                0.9678986576185529,
                -3388963.543818544,
                -4076033.4730802537,
                316182401.2128768,
                94242.36303729787,
                0.05925291542839839,
                4.087285789918421,
                0.6997706067568273,
                979.3439663201741,
                34197.59508114569,
                0.14147817772413063,
                -438723670.5240578,
                1600944393.6447732,
                50222798.00596297,
                -97749073.33020571,
                93230789.39334874,
                629532.0083102661,
                3421443.8472492127,
                -2.2545379125810783,
                230844835.03096664,
                8491449.0716902,
                -647550363.5289159,
                -0.8167335373816372,
                71271397.48299338,
                -270444212.79195285,
                3.733282548513661,
                -7925019564.669711,
                85577.09198291642});
  SCPMatrix m2({5,
                8,
                142671.65745090126,
                1.973025706000876,
                -29140.452438771248,
                45207108.35995956,
                76.93874803895844,
                -6903276.370269171,
                -560306.3113113876,
                8195.510849289147,
                -33567422.07096921,
                9304929.519677037,
                0.9375966840219002,
                9423.893062002664,
                -6016568.201574387,
                -8079724.841603032,
                -1834630.258805482,
                -0.38280685061575903,
                5.023148669230009,
                0.10662063179006587,
                564.7314033695014,
                74712.17508414174,
                44586.31223420173,
                228.0914684326407,
                0.2889803162376672,
                831556.045471721,
                9615351.137695668,
                -7.270936051942886,
                19028.419498230865,
                5688.952122961066,
                -93752.06032293459,
                0.15873012468856085,
                0.959863565228623,
                0.8471506931074296,
                -75197788.35713862,
                -202244.456455704,
                -0.8764560273214637,
                9.055857462156586,
                0.14670714798308138,
                455676.79816681496,
                -6591.757590531899,
                2841782297.9830775});

  EXPECT_THROW(m1.MulMatrix(m2), std::invalid_argument);
}

TEST(MulMatrix, 2) {
  SCPMatrix m1({4, 4, -0.8667596385369994, -96399519.33707213,
                -0.8132074715440049, -676721779.403161, -0.7264208926953934,
                9859092799.709126, 0.15351621278293437, -53561.17516810095,
                100236027.10087687, 8112210523.980933, -6911.951522896881,
                43013.754501458054, 627466.2752218087, -83516.26255114039,
                -0.41925498545099593, -6501615.50040502});
  SCPMatrix m2({4, 4, 187.25874835958456, 7413.231731175386, -847134697.3814652,
                8.34363385086623, 752261.2232428053, 5.986527177246125,
                7715206.871562433, 6.243044029207087, 0.6908660163659889,
                -90.0046841177724, 67.73932993333105, -20428092.961763866,
                -2.651655968192379, 0.36570912135290634, -674686.3672222877,
                8.72682763686915});
  SCPMatrix m1_res({4, 4, -72515825903342.06, -824588022.0283251,
                    -287166540776864.56, -6490848499.988539, 7416613209715411.0,
                    59021702001.696365, 76064977268058610.0, 61547146967.95206,
                    6102520181927198.0, 791637503319.0659, -22326063127904856.0,
                    192679583814.76962, -62691307230.797386, 4648675266.98412,
                    -527806247076807.8, -43459944.865799434});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 3) {
  SCPMatrix m1({2, 8, 6670650903.932236, -0.5908269116688124, 0.773480080813957,
                0.8824583295876475, 56.46485506375729, -424.4753236720208,
                651.5233955677505, 9.387665468518557, -882.9526594762937,
                0.32325873726095267, -371548.3524338237, -904556794.9166698,
                -12.840909066125006, 1342492047.8107028, -40894.27773545964,
                1891931080.751218});
  SCPMatrix m2({8, 2, -374573.5921164751, -932.8922777426362,
                2144700629.2987192, 2.2785226053886865, 382289.421180297,
                -2675867.0826004473, 620.9186415624935, -24271159.45404208,
                11196.543909103208, 85950.20122959312, 6310611387.274096,
                -219507.50607345538, -0.7112000602885967, 31713739.341352187,
                -32272.328405833185, -1738464.063453623});
  SCPMatrix m1_res({2, 2, -2501329636173913.0, -6202278252105.266,
                    8.47188384454671E+18, 18370598232165630.0});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 4) {
  SCPMatrix m1({3, 4, -0.24005725333125016, -86833.68896833093,
                4473.608223530524, 0.3177458422449153, -76282.8941598367,
                701116.6498116023, -1564628741.9436822, -21597750.582926277,
                19321.2369634426, 48649452.40182893, -10370514.57031536,
                -88139883.5566263});
  SCPMatrix m2({4, 3, 86154026.8555056, -0.48732939920754426,
                -1.1890949276712115, 160531580.52337325, 279688004.4634581,
                -349.4861297418751, 465.65893784206656, 296.1093096779788,
                -72.4306839670544, -0.7352504828534888, -959438067.1876513,
                74.54567124445218});
  SCPMatrix m1_res({3, 3, -13939567931484.795, -24286644720532.656,
                    30023167.357348736, 105250717935112.55, 20917334690466164.0,
                    111472171282.08054, 7811433323712537.0, 98171424711406380.0,
                    -22821635128.47995});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 5) {
  SCPMatrix m1({2, 2, 817796736.2257504, -498800728.66421044,
                -0.762049754703986, 4009895889.3010616});
  SCPMatrix m2({2, 2, -98634.0982816412, -66636.34060035044, 702.4204810829732,
                -23080.145702863043});
  SCPMatrix m1_res({2, 2, -81013011503088.94, -42982588362729.81,
                    2816633074819.5786, -92548981327599.88});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 6) {
  SCPMatrix m1({1, 1, -80.59824889343588});
  SCPMatrix m2({2, 2, -97564.39923607855, 1724.6985854618767,
                -326775052.8051994, -81365.5500677688});

  EXPECT_THROW(m1.MulMatrix(m2), std::invalid_argument);
}

TEST(MulMatrix, 7) {
  SCPMatrix m1({7,
                7,
                -4494627644.454517,
                -834.6209490502285,
                -677.4820027013425,
                477.9657471763713,
                -1112034085.2861266,
                0.24506791689351204,
                -34579.69107816342,
                7.0669814088159235,
                0.38659973797266445,
                0.43685543487760614,
                -328936.40225018316,
                -16.899666212124163,
                5921568.777589356,
                -696.3840739257785,
                860.982749018219,
                -731879.93218639,
                -0.32194434052078225,
                -425.926064125409,
                -302.557555004635,
                854027411.7781484,
                23461.219773142573,
                0.7897221675198356,
                -0.3230760497743448,
                -0.4078358352447162,
                -2949815.5949840476,
                -798143.2257664113,
                -9781.622639540594,
                71.22291331484057,
                0.8838936311679929,
                -2806479.9072515345,
                29690.01750343656,
                67.00044768906889,
                -10372.446668666247,
                792.164700132446,
                -1297469.1666221383,
                -107586576.88769436,
                -0.19930865890898952,
                96531226.98990485,
                9268714.607512796,
                -0.5796260691689769,
                -77.57899436877544,
                -556230927.4864384,
                -57932.84920044558,
                -0.8223566749136176,
                -235.97722910063956,
                0.12638301392753304,
                93634380.6526029,
                -75328842.18317479,
                0.37490859986067393});
  SCPMatrix m2({3, 3, 5161114.248542205, 820736.0105482447, -950888.5360441861,
                -403540709.40182483, -5186328128.468673, -0.5684290803040458,
                2.5334562759786894, 8004880996.953271, 0.2817755007568701});

  EXPECT_THROW(m1.MulMatrix(m2), std::invalid_argument);
}

TEST(MulMatrix, 8) {
  SCPMatrix m1({8,
                5,
                982976462.4522338,
                -220.04922269088155,
                -333675.3486740451,
                37634464.64419851,
                -72629.0272897198,
                -4390.177273145025,
                -120484696.63491668,
                -9466486583.28578,
                -85.78861207745601,
                -0.9323972962605309,
                844.115692851796,
                3406183835.205426,
                -299011.8669073242,
                83795.25291306463,
                4231.741356987907,
                -891826.1618510705,
                0.019291190166258132,
                2.8747459695161326,
                -54992699.657674395,
                -218792.94975403274,
                -568.3768833466467,
                -45202.12238979293,
                0.45761736756498106,
                1214651.2423544242,
                2427.105588625379,
                -200759.7330814622,
                -86085468.97945301,
                -23926.42476482426,
                838361726.6836858,
                -0.9718301110696469,
                66.75678077569029,
                0.8109022206729722,
                -8445089588.13657,
                -94493857.1245333,
                -0.6169544114413597,
                -52327083.13686484,
                366.6292502945353,
                106205151.44149522,
                -8610792.429831069,
                -51229923.01017967});
  SCPMatrix m2({5,
                8,
                -725846.882898542,
                -590161913.1215494,
                0.14250389313879686,
                -0.6549998749236865,
                -15674.010979424447,
                -797744518.9570997,
                -274813064.05090076,
                832.1561609100492,
                -0.8767675759949085,
                -0.8404769610652342,
                2452349324.054538,
                319.3603153350231,
                8272952131.048277,
                -4.166208934695455,
                16.83807436835536,
                1.5366680473718908,
                61065.74545685724,
                -23488063.501708746,
                70820.25266774744,
                54644603.14600889,
                -5.147994776707867,
                79840364.62668997,
                0.14928906827852773,
                404068925.9221558,
                -50082952.68372235,
                -7728284.897132699,
                -4100.182189551081,
                -685818.293913175,
                9.947664740928674,
                0.5478847503074953,
                6498705584.672133,
                -420408615.58651596,
                -0.24038744876801832,
                -61747116.59184364,
                -627.3337011306854,
                60418.7403959886,
                -27592.731518697045,
                5.46369015770761,
                -4958989.724031594,
                -77130054.06068705});
  SCPMatrix m1_res({8,
                    8,
                    -2598355889402460.5,
                    -5.803937974781898E+17,
                    -717391056064.9746,
                    -44048993416599.25,
                    -17225260424741.756,
                    -7.841907259263903E+17,
                    -25559107810468324.0,
                    -15950261148432446.0,
                    -578070471285119.4,
                    2.2235202974354502E+17,
                    -2.9614098332290643E+17,
                    -5.172924409499178E+17,
                    -9.967640789822792E+17,
                    -7.55804237801384E+17,
                    645525786255.1115,
                    -3.8251130300153943E+18,
                    -4218572200625.0107,
                    5613290551959.821,
                    8.353152604349194E+18,
                    -15308797500858.98,
                    2.8179195818077303E+19,
                    -24560795953422.637,
                    544365072425367.1,
                    -156370809732460.75,
                    2754844104373271.5,
                    964830850322555.6,
                    225664729121.37918,
                    37701937935979.07,
                    19628134311.94254,
                    711449630674926.6,
                    -3.571351939093973E+17,
                    23136280661947468.0,
                    -60832908076479.055,
                    -9201613945037.258,
                    -110856376070107.16,
                    -832872829140.887,
                    -373955040731328.9,
                    453456946800.5238,
                    7893804972757701.0,
                    -510836865637407.7,
                    -41987486354124344.0,
                    -6360055404765688.0,
                    -2.111150807930031E+17,
                    -576298751272023.8,
                    -7.121809525592545E+17,
                    158245500191240.16,
                    5.44832120512733E+18,
                    -3.524641610249562E+17,
                    4216825635665716.0,
                    1.9908903661344416E+17,
                    -597693947787681.8,
                    -4.614137634603732E+17,
                    49242809809.33583,
                    -6.742590853285144E+17,
                    -6.140877766157508E+17,
                    -3.372672247491928E+18,
                    475720869077492.56,
                    31616744837044320.0,
                    8488015271997.767,
                    5806348578528208.0,
                    5266222623639.564,
                    50223101497144540.0,
                    -41324790124875800.0,
                    50485575981888940.0});

  m1.MulMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(MulMatrix, 9) {
  SCPMatrix m1({1, 6, -18918.982877334445, -0.10851017933987028,
                -69971.74301141965, 0.7015427779456294, 63.11335284537284,
                -6458.999412169419});
  SCPMatrix m2({4,
                6,
                91.81125636629555,
                2.4586022368174163,
                0.26276053531527266,
                286.12503899095265,
                586.033884052092,
                94671.67644812385,
                -794648.3089838574,
                7.279092810200862,
                927.5942108225389,
                8623914.613398733,
                -21636.564900168498,
                0.749382805451883,
                6481.734181105847,
                84139742.59074526,
                -3084192.1967938244,
                -86176283.67878146,
                -6.755171009546169,
                -8.89742185725066,
                -7740639.033874341,
                -0.1950737867418585,
                -0.9497817659832036,
                -286213.7397492462,
                -578.1101817605308,
                964.8080125241887});

  EXPECT_THROW(m1.MulMatrix(m2), std::invalid_argument);
}