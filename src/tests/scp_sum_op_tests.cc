#include "scp_matrix_oop_tests.h"

TEST(SumMatrixOP1, 0) {
  SCPMatrix m1({8,
                8,
                61.49356628380178,
                -960.1065290736246,
                -853481.8983531996,
                -875.8315019334839,
                -19.989234481535178,
                0.4947112025976571,
                -0.21690180376508827,
                -3464690.228810232,
                455.5998551978868,
                0.2536509809197338,
                -530384.3778650063,
                -0.6824958050989642,
                70.00701486214774,
                488853.5223142573,
                -47.51504803177829,
                70660975.14035863,
                1380.8242127127223,
                671270434.3993272,
                -264432777.4311126,
                -9.409140328553146,
                76.51945857427972,
                9.36710725329866,
                1360671282.4760637,
                -596140039.1546385,
                0.9608006000670594,
                9001330373.666803,
                5946304.757997234,
                769.1297513967445,
                -1765533.9360361998,
                9027697.472160636,
                -573763954.5277218,
                -13.913528858436841,
                -8.373772137167704,
                468.33296239436737,
                -98.78451948820147,
                54.692601111839366,
                -26.421686279885005,
                -6655.778947938572,
                -8160.171688376427,
                286605.59245685657,
                -679406.1439730729,
                0.7423887731488245,
                40423.77895796385,
                0.1332994223033297,
                -0.17954392247934325,
                -401738082.1419655,
                232610104.41175035,
                -38929.48758147333,
                -56985569.90421377,
                -0.8044705810114197,
                32.008767484765286,
                -741167793.3270423,
                1672175.8825928424,
                -0.827401948659623,
                -8.463901418389417,
                122116613.23746015,
                845512.9219223084,
                -645744.3787108153,
                -912110.4493413753,
                -0.8920033184809116,
                846.786958212897,
                -1853298.0274564158,
                -257834143.5943503,
                -0.9561518314962165});
  SCPMatrix m2({8,
                8,
                -0.6221303556294491,
                66.04632913762158,
                -5451.193025386403,
                0.6631253275840179,
                6113.2703899384915,
                42195965.155060776,
                18450.964034874007,
                -944.4058259430305,
                -7409216.271292579,
                1.2936663997895814,
                316583.4442947174,
                3.610719087188742,
                -551919.4716093102,
                3.327375800231358,
                -2.514854645025965,
                754.9703831484355,
                -0.4193892302873179,
                -71.89155168569738,
                -5846571.974479266,
                0.7862461139688331,
                -0.8549873743749737,
                88269062.7980742,
                1108808491.460922,
                0.8814380225949904,
                5332164.062652276,
                -220.71699140107125,
                -7359990.6912641255,
                -0.03702140364250839,
                -79260631.76345763,
                -33276.64922299889,
                3634486256.8081837,
                -43.12163549523513,
                2488.657194599242,
                0.5785173501534556,
                22.039963398231144,
                -4538578676.026252,
                1015681369.9580624,
                4.578200797257459,
                -7545.058031221679,
                -0.4965692103542533,
                -20925205.56924242,
                5281090805.732749,
                2166589.6208953317,
                -196910.67665907924,
                6317.628651965552,
                78402141.45360614,
                -9883111.862623503,
                -0.45653929824986283,
                -41037243.10422663,
                -69.99717420248619,
                85771.95354433412,
                91.3298995658253,
                -38869924.1523008,
                4540911889.449617,
                -7055.727518638598,
                -9522671.142277256,
                7.306870041354775,
                7773296166.506643,
                6849542.351196558,
                980.6616340939363,
                -6237.315220602499,
                815409.1955179682,
                63431056.55462349,
                -0.7998723108339113});
  SCPMatrix m1_res({8,
                    8,
                    60.87143592817233,
                    -894.0601999360031,
                    -858933.091378586,
                    -875.1683766058999,
                    6093.281155456956,
                    42195965.64977198,
                    18450.747133070243,
                    -3465634.6346361754,
                    -7408760.671437382,
                    1.5473173807093152,
                    -213800.93357028894,
                    2.928223282089778,
                    -551849.4645944481,
                    488856.8496900575,
                    -50.029902676804255,
                    70661730.11074178,
                    1380.404823482435,
                    671270362.5077754,
                    -270279349.40559185,
                    -8.622894214584313,
                    75.66447119990475,
                    88269072.16518146,
                    2469479773.936986,
                    -596140038.2732005,
                    5332165.023452876,
                    9001330152.949812,
                    -1413685.9332668912,
                    769.092729993102,
                    -81026165.69949383,
                    8994420.822937636,
                    3060722302.280462,
                    -57.03516435367197,
                    2480.283422462074,
                    468.9114797445208,
                    -76.74455608997033,
                    -4538578621.333651,
                    1015681343.5363761,
                    -6651.200747141314,
                    -15705.229719598105,
                    286605.0958876462,
                    -21604611.713215493,
                    5281090806.475138,
                    2207013.3998532956,
                    -196910.54335965693,
                    6317.449108043073,
                    -323335940.6883594,
                    222726992.54912683,
                    -38929.94412077158,
                    -98022813.0084404,
                    -70.80164478349761,
                    85803.96231181888,
                    -741167701.9971428,
                    -37197748.269707955,
                    4540911888.622215,
                    -7064.191420056987,
                    112593942.0951829,
                    845520.2287923497,
                    7772650422.127933,
                    5937431.901855183,
                    979.7696307754554,
                    -5390.528262389602,
                    -1037888.8319384477,
                    -194403087.03972682,
                    -1.7560241423301277});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 1) {
  SCPMatrix m1({1, 1, 58701877.20069275});
  SCPMatrix m2({1, 1, 80866809.58969878});
  SCPMatrix m1_res({1, 1, 139568686.79039153});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 2) {
  SCPMatrix m1({3, 3, -0.5694129202517216, 0.6200879013819285,
                -0.727134719033829, -6648787.898751973, 3241014937.954668,
                1.5304569679582591, -285088.00550373725, -4255.438909984965,
                -207006074.77125922});
  SCPMatrix m2({3, 3, -173876851.07449624, 1500740204.5287642,
                8751.469380971424, 663472263.5896968, 328106966.1934105,
                5803312.304089934, -1375219943.7604141, 262397652.0142747,
                6327178.300569486});
  SCPMatrix m1_res({3, 3, -173876851.64390916, 1500740205.148852,
                    8750.74224625239, 656823475.6909448, 3569121904.1480784,
                    5803313.834546901, -1375505031.7659178, 262393396.5753647,
                    -200678896.47068974});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 3) {
  SCPMatrix m1({2, 6, -897076224.3607916, -0.5977138230531812,
                -5690072.057133539, 66.86827978592905, 349.0474876554899,
                -94503812.35145411, -33.83044829570716, 3583.7768324109666,
                67503502.43280329, 9.404694418756577, -90217260.41036393,
                -0.007056496254266964});
  SCPMatrix m2({2, 6, 0.5254873381838764, 0.2723917020943324, 68772043.1870324,
                -7438220.057165001, -19.616408027674947, -564.8184973007654,
                -7.653409918056598, -14142.461252560644, 792.9722334872547,
                0.6416542680789995, 555.0022362374035, -78000908.0647356});
  SCPMatrix m1_res({2, 6, -897076223.8353043, -0.3253221209588488,
                    63081971.12989886, -7438153.188885215, 329.43107962781494,
                    -94504377.16995141, -41.48385821376375, -10558.684420149679,
                    67504295.40503678, 10.046348686835577, -90216705.4081277,
                    -78000908.0717921});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 4) {
  SCPMatrix m1({9, 1, 310524.46456277283, -9329276842.863121,
                0.3667860560283477, -305359151.2195613, -7733020.847103788,
                -0.2899315128587292, -954139.1830046832, 56.07903493038189,
                -69502.13683302961});
  SCPMatrix m2({9, 1, 453884.25250114163, 398811.5509185157, 90.55176862873768,
                0.48093189669169, 28251.75208165127, 0.19825927872658955,
                0.8780234337635129, 3.672138800825482, -587.3081575231093});
  SCPMatrix m1_res({9, 1, 764408.7170639145, -9328878031.312202,
                    90.91855468476602, -305359150.7386294, -7704769.095022136,
                    -0.09167223413213965, -954138.3049812495,
                    59.751173731207366, -70089.44499055271});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 5) {
  SCPMatrix m1({5,
                5,
                -2774968506.147283,
                -0.4178198032021262,
                -66195.1290604221,
                608591.8375549711,
                210974.22501371344,
                -3169.998542581702,
                -3837.578250811252,
                -0.5458724194242082,
                4883133.345773904,
                143060.27327279036,
                54093.726174332754,
                3.3724457807191985,
                0.3835097328190762,
                -9803844513.068317,
                -7178.073597693495,
                3.3717144216276793,
                -75889.94220383337,
                0.5954016485665085,
                -0.567763886605664,
                8.616150675240164,
                0.2164114178295613,
                990025291.2812908,
                -33253164.353928734,
                2.8902700301603224,
                0.5179027741810449});
  SCPMatrix m2({5,
                5,
                492.0111691196568,
                5945579.655507663,
                -1.7189984977512607,
                89.8396846251179,
                7120491763.228221,
                0.2526808313731198,
                -725575594.2631605,
                1.370445598335509,
                -2.865889672908828,
                -981781596.1450758,
                -75.37638747830276,
                21.473010101042632,
                882309448.1173222,
                36901270.38408927,
                93.20285861846052,
                539935.794394365,
                -1.6095594884008435,
                399286.11819190474,
                -64672.863576872165,
                25271.888083850135,
                -0.2525585979534134,
                -556.7803837317973,
                935148624.2544585,
                0.6165464843137441,
                -776.6191949694701});
  SCPMatrix m1_res({5,
                    5,
                    -2774968014.136114,
                    5945579.23768786,
                    -66196.84805891984,
                    608681.6772395963,
                    7120702737.453235,
                    -3169.745861750329,
                    -725579431.8414112,
                    0.8245731789113009,
                    4883130.4798842305,
                    -981638535.871803,
                    54018.34978685445,
                    24.84545588176183,
                    882309448.500832,
                    -9766943242.684229,
                    -7084.870739075034,
                    539939.1661087867,
                    -75891.55176332177,
                    399286.7135935533,
                    -64673.43134075877,
                    25280.504234525375,
                    -0.036147180123852096,
                    990024734.5009071,
                    901895459.9005299,
                    3.5068165144740666,
                    -776.101292195289});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 6) {
  SCPMatrix m1({7,
                8,
                -7894368.275264705,
                -302277788.68907094,
                4591.2137444131995,
                -0.974901525911535,
                5.811832458061689,
                -0.41092036180682023,
                -972582441.7198693,
                818106966.9123884,
                -762.4193219531938,
                -0.14597800216491952,
                -0.10628726353427065,
                91938.72039713443,
                -1.046216231027215,
                79673096.55145721,
                -7988862325.072204,
                -51558817.314121045,
                -187.85117252003835,
                -230839726.9676715,
                -41386250.47619573,
                376406224.2248032,
                3.9584803426005566,
                -0.3878862773043704,
                488874.51064631337,
                -124699180.56359008,
                961057.4800078704,
                0.3229877397775037,
                -977576.2889024174,
                98.42215392860948,
                57.670299528254596,
                51.36701739278004,
                70548089.27200326,
                566328146.2326641,
                -92771112.01000665,
                5357457.160797888,
                279.5030376077562,
                582531811.6192368,
                -0.10410314234572282,
                7.700047074715112,
                3410072139.266078,
                0.6444041730689973,
                -0.9702576051078645,
                -0.9655075251515952,
                -685166201.1521357,
                0.2011588179800814,
                -854974604.1535349,
                -5814037597.961169,
                -6386697748.369619,
                6959618.8693581475,
                -75541.02317754293,
                -5612.7461357377115,
                -1043413.9644514817,
                -782.0558543181289,
                42403.24715180261,
                4808569.483881784,
                41831.77659079841,
                -87450720.00420617});
  SCPMatrix m2({7,
                8,
                142716.85390615306,
                -29129370.596456595,
                -50726.90203559465,
                94.86538710010551,
                2206051.773487229,
                -6.199685940200419,
                -31.306017580039004,
                -0.5819214970418037,
                -61.71645224617877,
                0.4165875855565473,
                84345195.16593623,
                -6317.968032278153,
                1377605.3725595605,
                0.8621382953410891,
                6003512.167530054,
                -433.1242200943455,
                -3150064.0057334793,
                -0.740320940598496,
                -0.18646955302657142,
                -37680059.42449639,
                -1683942.951420353,
                459.28730422312447,
                -405423.463523512,
                -9.633877496846146,
                587040.1431327615,
                -89844735.37281704,
                -35166173.83622568,
                -7988281.685228326,
                72.49475296890421,
                -0.6785155773871685,
                -986.3812558345217,
                -61.56025715345521,
                -74821.4414456921,
                -0.3488320758316962,
                -412.8948777284257,
                -450365850.1001485,
                -0.42283705902662805,
                -8177040.3995433375,
                -37.53988165584757,
                -83.3485605545301,
                393946.8022242547,
                -0.09957941871625564,
                36641.894864519694,
                -9083950341.476492,
                -548.7052357507447,
                -17.822631475985208,
                -16033.930455155698,
                -215794716.88998973,
                3.8549969422169927,
                52.435260937542196,
                -63.0761860921339,
                0.5872628275684643,
                5014931.309945359,
                -0.18151369811099138,
                58000.8257389921,
                5696203348.103382});
  SCPMatrix m1_res({7,
                    8,
                    -7751651.421358552,
                    -331407159.2855275,
                    -46135.68829118145,
                    93.89048557419397,
                    2206057.585319687,
                    -6.610606302007239,
                    -972582473.0258869,
                    818106966.330467,
                    -824.1357741993726,
                    0.2706095833916278,
                    84345195.05964896,
                    85620.75236485628,
                    1377604.3263433294,
                    79673097.41359551,
                    -7982858812.904674,
                    -51559250.43834114,
                    -3150251.856905999,
                    -230839727.70799246,
                    -41386250.662665285,
                    338726164.8003068,
                    -1683938.9929400105,
                    458.8994179458201,
                    83451.04712280136,
                    -124699190.19746758,
                    1548097.6231406317,
                    -89844735.0498293,
                    -36143750.1251281,
                    -7988183.263074398,
                    130.1650524971588,
                    50.688501815392875,
                    70547102.89074743,
                    566328084.6724069,
                    -92845933.45145234,
                    5357456.811965813,
                    -133.39184012066949,
                    132165961.51908833,
                    -0.5269402013723509,
                    -8177032.699496263,
                    3410072101.7261963,
                    -82.7041563814611,
                    393945.83196664957,
                    -1.065086943867851,
                    -685129559.2572712,
                    -9083950341.275333,
                    -854975152.8587706,
                    -5814037615.783801,
                    -6386713782.300075,
                    -208835098.02063158,
                    -75537.16818060071,
                    -5560.31087480017,
                    -1043477.0406375738,
                    -781.4685914905605,
                    5057334.557097161,
                    4808569.302368086,
                    99832.6023297905,
                    5608752628.099176});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 7) {
  SCPMatrix m1({7,
                8,
                0.6760331824612327,
                -65.36302223343066,
                923593517.9950413,
                93457.63629861065,
                -0.5237004072260713,
                7744750.728541937,
                2.3583541819587985,
                -66.96286705926308,
                -22411.175794745173,
                -71067.82832463091,
                -9.352271155568243,
                0.08264304931251154,
                600717943.632747,
                -73.47634458843594,
                -35174.731717637886,
                -4026338677.466581,
                -841375.1929946408,
                -21302.052219111923,
                450184.8227701674,
                -25726622.631212357,
                -0.15101751892855497,
                -620093.1215853401,
                0.2625622267165152,
                -2397220150.87095,
                -0.27000705198099817,
                672.4233192478088,
                3617705755.7754364,
                -502529.83974648046,
                -13.57754780864715,
                -432787.3359430474,
                -31279.152612376805,
                -345235.1934873099,
                -45456452.10291105,
                8864.913164523137,
                789077753.3079877,
                -0.4320514804683562,
                -42711.404778583674,
                7217075.650301041,
                2252.456417453633,
                0.704809503388054,
                0.9848875815583156,
                96907.0060200571,
                905.0375178964614,
                -0.20798172168943174,
                158.12502972848185,
                -14854035.690109845,
                -92712834.23699722,
                -83.44040964809439,
                -0.1864929805428751,
                -0.8020219675608288,
                185767677.42682022,
                -18535878.322032206,
                -0.1549267581870435,
                -0.971384023543299,
                -731817750.0467337,
                5.938613914811643});
  SCPMatrix m2({7,
                8,
                677.7208176749305,
                89760.90655014796,
                -0.058816663295535254,
                805.128855511974,
                2.121465380759129,
                5795514105.111679,
                -45321481.64220091,
                677945600.3944857,
                -94.79527334945547,
                -71856.74230631505,
                -71.1668828021707,
                30777.82528704722,
                9685464941.28778,
                -12.454268315968575,
                -4.4663549113198755,
                0.6649495493117813,
                4153.106781554752,
                -991242.9471526273,
                7008.357669466718,
                2711999.0659584347,
                15912.119486596943,
                -1769028.7236655145,
                93879128.77753769,
                0.16758165449729523,
                -7685.636383545985,
                -221.97533767979505,
                9.61792432875602,
                195.21510973127675,
                -9904469.496445034,
                -5054.704911067995,
                9.37063679970612,
                -0.9447693509037827,
                0.9976275094579845,
                -0.6615159659196704,
                590353822.565727,
                -0.8172741353476171,
                0.9319192574631102,
                74.41718250503058,
                -3862997209.0377464,
                451995148.8626677,
                -100.2478775849821,
                -0.6093980508950124,
                0.41101657908542943,
                -787.4426937207227,
                893018.9720601045,
                0.24928949293133829,
                -0.8560480970191666,
                -377657623.09032136,
                -769833981.5719378,
                422.1194482050606,
                -52968.34350252515,
                21456.47220018606,
                63440450.4604681,
                -5003794.704817679,
                52.95701110422827,
                -45537.229566957});
  SCPMatrix m1_res({7,
                    8,
                    678.3968508573917,
                    89695.54352791453,
                    923593517.9362246,
                    94262.76515412262,
                    1.5977649735330575,
                    5803258855.840221,
                    -45321479.28384673,
                    677945533.4316187,
                    -22505.97106809463,
                    -142924.57063094596,
                    -80.51915395773895,
                    30777.90793009653,
                    10286182884.920528,
                    -85.93061290440451,
                    -35179.1980725492,
                    -4026338676.8016315,
                    -837222.086213086,
                    -1012544.9993717392,
                    457193.1804396341,
                    -23014623.56525392,
                    15911.968469078014,
                    -2389121.8452508547,
                    93879129.04009992,
                    -2397220150.7033687,
                    -7685.9063905979665,
                    450.4479815680137,
                    3617705765.3933606,
                    -502334.62463674915,
                    -9904483.073992843,
                    -437842.04085411545,
                    -31269.781975577098,
                    -345236.13825666084,
                    -45456451.105283536,
                    8864.251648557218,
                    1379431575.8737147,
                    -1.2493256158159731,
                    -42710.47285932621,
                    7217150.067483546,
                    -3862994956.581329,
                    451995149.56747717,
                    -99.2629900034238,
                    96906.39662200621,
                    905.4485344755468,
                    -787.6506754424121,
                    893177.097089833,
                    -14854035.440820353,
                    -92712835.09304531,
                    -377657706.530731,
                    -769833981.7584308,
                    421.3174262374998,
                    185714709.0833177,
                    -18514421.84983202,
                    63440450.305541344,
                    -5003795.676201702,
                    -731817697.0897226,
                    -45531.29095304219});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 8) {
  SCPMatrix m1({1, 1, -0.7177013520906237});
  SCPMatrix m2({1, 1, -8492727.009409374});
  SCPMatrix m1_res({1, 1, -8492727.727110725});

  EXPECT_TRUE(m1 + m2 == m1_res);
}

TEST(SumMatrixOP1, 9) {
  SCPMatrix m1({9,
                3,
                3.4500157213044904,
                -3515.9846472487134,
                -0.44525837780678135,
                0.49788659556915227,
                -52.20768696423017,
                970.0319693747304,
                6690330878.016116,
                -9026753.419235703,
                0.0904792751581237,
                18437609.128729228,
                -319.511613440607,
                -79.70442497626945,
                -0.27158751803287806,
                6.078399296585067,
                -6285835907.755272,
                6.531063396413091,
                -731837197.4507923,
                276839.44527471584,
                27263590.96240779,
                6918619.642823856,
                -3245004.8175780023,
                6350.54195626157,
                -776.8663846243253,
                27514239.788367,
                0.7735625953405577,
                50.73194960930169,
                0.44030197929213366});
  SCPMatrix m2({1, 2, -1798346.7368360374, -671.5249521564452});

  EXPECT_THROW(m1.SumMatrix(m2), std::invalid_argument);
}

TEST(SumMatrixOP2, 0) {
  SCPMatrix m1({1, 2, -5856196548.94238, 28.80287291051794});
  SCPMatrix m2({1, 2, 505.64216079961534, 8.81879527614288});
  SCPMatrix m1_res({1, 2, -5856196043.30022, 37.62166818666082});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 1) {
  SCPMatrix m1({5,
                5,
                -35262.62398208244,
                22.828427473453537,
                0.5085448915326581,
                -4531643756.5863285,
                7295686.373850972,
                -247.94320999464304,
                -0.42276484548533944,
                -573315988.2375004,
                -7.003727290657071,
                575.454418791256,
                4.350254627546865,
                -8536347.700938417,
                -2173.2631296238415,
                7868624415.333545,
                -18596.722318840297,
                22591.123856476548,
                75113029.78786224,
                -372149.61278835323,
                -78.78183891391527,
                5.690670825901635,
                88.20027575752438,
                4439.735951113125,
                -222807.97285760002,
                68938176.14607053,
                18725.657076796055});
  SCPMatrix m2({5,
                5,
                -0.419601947182736,
                603.068049828237,
                -43849.52968510566,
                -55634300.43575033,
                7.284581314904019,
                -2654.3937896997427,
                -0.5961781083107971,
                53.853169643718104,
                -2.600183360888313,
                78.1276816914726,
                -0.6635677193379571,
                0.9437996731181577,
                74.01216677004095,
                6.751485966988628,
                7006.84674948631,
                -0.6104568480738994,
                97321564.22357324,
                0.8271763502063185,
                17001.973612662503,
                -426.1165433426749,
                8341.006354348856,
                67975681.44483617,
                8128412074.889164,
                0.4254426846624523,
                0.49920660774478753});
  SCPMatrix m1_res({5,
                    5,
                    -35263.04358402963,
                    625.8964773016905,
                    -43849.02114021413,
                    -4587278057.0220785,
                    7295693.658432287,
                    -2902.3369996943857,
                    -1.0189429537961365,
                    -573315934.3843307,
                    -9.603910651545384,
                    653.5821004827286,
                    3.6866869082089075,
                    -8536346.757138744,
                    -2099.2509628538005,
                    7868624422.085031,
                    -11589.875569353986,
                    22590.513399628475,
                    172434594.01143548,
                    -372148.785612003,
                    16923.19177374859,
                    -420.42587251677327,
                    8429.20663010638,
                    67980121.18078728,
                    8128189266.9163065,
                    68938176.5715132,
                    18726.1562834038});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 2) {
  SCPMatrix m1({7,
                5,
                7590220.879732201,
                -62.28626792088836,
                744006.3588243953,
                -8390495374.282615,
                582611250.6497732,
                8.415608341782868,
                0.3596623979742162,
                -8352762857.705793,
                -2415.17009525569,
                7312.593691666406,
                -33.74279874909679,
                0.301629375649211,
                -85011.27096301262,
                -608.9729838406013,
                -8452717932.234348,
                -611590452.1789496,
                0.2580749300338647,
                -71208.49924740242,
                0.4711245709628682,
                79.78604537641075,
                -0.5522810133668765,
                2682.2871092148994,
                5.728074250409771,
                537821.1614806991,
                933436.0388546557,
                26.6213314858858,
                8305210.6735558575,
                160.3556604004297,
                4.833353413192542,
                897595.9056485875,
                22.85666840442876,
                -190390.40656315142,
                -4895.061795846146,
                5006329.341544341,
                -0.5396360199800415});
  SCPMatrix m2({7,
                5,
                0.14652332622901376,
                721210892.4129775,
                -429652026.8673871,
                6852.446569508313,
                -2433603.771279175,
                87728.61935952125,
                282899427.49077713,
                6007557.625410402,
                -0.13143025759788274,
                0.5873988139155869,
                -0.1112238593700885,
                202156.52966814768,
                7298830.005115847,
                4023.3998384622096,
                -8071.227705787512,
                91.13524913448818,
                0.5439884187497412,
                36512.72499165901,
                -6437.0678705316095,
                4356.111623434234,
                -0.7816435437806253,
                -0.2927745544045456,
                -0.9694123221072692,
                -2.5915325155458135,
                -0.2091141997217567,
                74.00799344798503,
                0.5117002655786513,
                -144.2931898118437,
                -8208318025.404826,
                0.7231854620087338,
                3.39011353019816,
                430168406.8674728,
                -28880627.2043,
                8341.230274790854,
                8.047983191133635});
  SCPMatrix m1_res({7,
                    5,
                    7590221.0262555275,
                    721210830.1267096,
                    -428908020.50856274,
                    -8390488521.836045,
                    580177646.878494,
                    87737.03496786303,
                    282899427.85043955,
                    -8346755300.080383,
                    -2415.3015255132877,
                    7313.1810904803215,
                    -33.85402260846688,
                    202156.8312975233,
                    7213818.734152835,
                    3414.426854621608,
                    -8452726003.462054,
                    -611590361.0437005,
                    0.802063348783606,
                    -34695.77425574341,
                    -6436.596745960646,
                    4435.897668810645,
                    -1.3339245571475018,
                    2681.994334660495,
                    4.758661928302502,
                    537818.5699481835,
                    933435.829740456,
                    100.62932493387083,
                    8305211.185256124,
                    16.062470588586024,
                    -8208318020.571473,
                    897596.6288340496,
                    26.24678193462692,
                    429978016.46090966,
                    -28885522.266095847,
                    5014670.571819132,
                    7.508347171153594});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 3) {
  SCPMatrix m1({6,
                6,
                7812.671728118923,
                24.938491098297742,
                278930.68774935027,
                763.555536578101,
                1507028951.9847147,
                -3827.495295020016,
                591.8761965414857,
                8045391.296311363,
                0.011689303767339898,
                -53254708.7466237,
                -5571820.239838198,
                -938.2993272097923,
                256120981.82607844,
                8442495.277438061,
                1679.7524305571687,
                362116.8339620048,
                4594.867055642558,
                0.20363556726818266,
                -6654.2260384459505,
                -49185570.32161274,
                29230.017390301167,
                43.898704262230915,
                -356867.3734026868,
                0.276142548609539,
                33.096191306686116,
                -4520582253.485347,
                -57.28906884558671,
                409.91423068776976,
                38557220.67546809,
                22207510.706874322,
                0.8625650219107344,
                -1044.7241085883607,
                -92360995.95196769,
                -5257.47819903624,
                282957918.2719236,
                13985017.570450919});
  SCPMatrix m2({6,
                6,
                -761.0649550881785,
                2933754756.8613777,
                265.58909937182585,
                -56373.26322348303,
                0.9486739846676082,
                -0.9178393534865738,
                -0.23895628890681508,
                0.8932381445146206,
                466831.2950772041,
                -31827719.7754377,
                25334.752818497607,
                279958.65275454713,
                7769.4433848379485,
                -9397077.22009202,
                -735714189.3489593,
                0.2853780107714933,
                466898.8772659325,
                -0.8935427776497364,
                24566140.248616207,
                -0.25081334275355116,
                916441582.7927943,
                45747774.53665674,
                -80260079.5555262,
                950304563.4261272,
                307233.5398152012,
                -424587780.68842906,
                -0.36196700173266383,
                31.91934868504739,
                -53239.35006738448,
                -5891019.735965839,
                13.711515709830236,
                3769.286695930932,
                -87.05647553592482,
                -613.505680262246,
                771.198198356482,
                4136.313528392905});
  SCPMatrix m1_res({6,
                    6,
                    7051.606773030744,
                    2933754781.7998686,
                    279196.2768487221,
                    -55609.70768690493,
                    1507028952.9333887,
                    -3828.4131343735025,
                    591.6372402525789,
                    8045392.189549508,
                    466831.3067665079,
                    -85082428.52206141,
                    -5546485.4870197,
                    279020.35342733737,
                    256128751.26946327,
                    -954581.9426539596,
                    -735712509.5965288,
                    362117.1193400156,
                    471493.74432157504,
                    -0.6899072103815538,
                    24559486.022577763,
                    -49185570.57242608,
                    916470812.8101846,
                    45747818.435361,
                    -80616946.92892888,
                    950304563.7022698,
                    307266.6360065079,
                    -4945170034.173776,
                    -57.65103584731938,
                    441.83357937281716,
                    38503981.3254007,
                    16316490.970908483,
                    14.57408073174097,
                    2724.5625873425715,
                    -92361083.00844322,
                    -5870.983879298486,
                    282958689.470122,
                    13989153.883979311});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 4) {
  SCPMatrix m1({4, 4, 0.09446135012043366, 83.55731201852635,
                33761.007644020436, 94650.69166733653, -0.461457442505941,
                22216.01632883511, -0.39529543876524187, 36.355817501512,
                9540.446226262791, 8126453.815339041, 0.673105200598263,
                -96389811.80333461, -901677.2805149537, -30.89593264939343,
                82.85204220204439, 66696145.81890608});
  SCPMatrix m2({8,
                8,
                36648.03761974079,
                -0.5935831961932797,
                157907.12079540448,
                -53.75749093905916,
                -84964.8556119583,
                5.876239022125631,
                -368816639.3959413,
                -7489.397233707007,
                431391.7317273929,
                -0.9765709927487056,
                -0.7067582161694549,
                71.04726395966956,
                -4640.688350919797,
                7130.268790180361,
                -0.6041432573548413,
                -0.9445882787116344,
                9092902.199651299,
                929631.6580003434,
                -2.7612832832991794,
                -607334601.3532448,
                -0.9807222324022368,
                5.896903879906532,
                8193511463.12631,
                9912376626.254332,
                -17364.17970704166,
                -2824080.695110627,
                -9394803939.749817,
                4908284.940563956,
                62378631.86476306,
                -2.5029254044953877,
                -714189.076711466,
                4489640.218123164,
                -1603821.4658889594,
                8083.78602531945,
                -0.9843913195041553,
                -9.122409985688211,
                3.625148104977974,
                -71613031.1379843,
                -0.863504352568617,
                81301200.20489712,
                324829.13249561965,
                -2080.500744826681,
                -0.26555467868701654,
                -1561.3481870521528,
                0.8438576525036442,
                -81.03988032835788,
                -304725.1503042103,
                11.86963570262879,
                -78318778.04374315,
                5519.60158337911,
                1225259732.5340965,
                8384.018010123124,
                -56.023022630309306,
                0.7336877321923104,
                107331761.834628,
                -455747.1210665395,
                12315.658370299,
                20730.07660275751,
                -7995416.230207502,
                68314389.54510292,
                32993.74784095771,
                -0.09921714035229157,
                373.2221726384178,
                -573653.043755974});

  EXPECT_THROW(m1.SumMatrix(m2), std::invalid_argument);
}

TEST(SumMatrixOP2, 5) {
  SCPMatrix m1({4,
                5,
                -4815.683002705463,
                -30.396827449493415,
                -7243.201541366283,
                1142.129788447489,
                3406.541545704034,
                -378853.14305311226,
                -0.12453919906502142,
                6163922.485527146,
                74369312.73348226,
                -41569535.37211286,
                -915183.7724285983,
                530458689.92688996,
                979.2660025553048,
                -481123085.4477773,
                -7.1337041830456975,
                -3146699825.298179,
                51.03253493513571,
                -4.222041078902825,
                857686230.8173447,
                1350.3896182044195});
  SCPMatrix m2({4,
                5,
                -0.2650230679638226,
                87471030.06117964,
                -2.566359859569056,
                4794603.7264717575,
                -8664.771515884839,
                92352.07688813383,
                -0.2884989446836074,
                -0.01374551363456078,
                -99.78378677398919,
                357213.64883881045,
                16034017.512980392,
                -3967.5634411758974,
                0.9899384196185681,
                30542.502531796068,
                83000.55000479895,
                -325046832.84363425,
                0.6360865010946689,
                621.3915427514452,
                8630290.713157913,
                -3902234.7426745687});
  SCPMatrix m1_res({4,
                    5,
                    -4815.948025773427,
                    87470999.6643522,
                    -7245.767901225852,
                    4795745.856260205,
                    -5258.229970180804,
                    -286501.06616497843,
                    -0.4130381437486288,
                    6163922.471781632,
                    74369212.94969548,
                    -41212321.72327405,
                    15118833.740551794,
                    530454722.3634488,
                    980.2559409749234,
                    -481092542.9452455,
                    82993.4163006159,
                    -3471746658.1418133,
                    51.668621436230374,
                    617.1695016725423,
                    866316521.5305026,
                    -3900884.353056364});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 6) {
  SCPMatrix m1({6,
                6,
                -64027328.98535317,
                390.4170707156548,
                4994933161.039631,
                848.861248277482,
                59230.20425796477,
                34976.56760925649,
                5142.256189069319,
                5493.5267417643545,
                6251.4100481961395,
                -8.705137748683311,
                -5911493.518457792,
                -578177.7888253826,
                3187028578.9626684,
                -0.4514827173427973,
                9343675223.548048,
                -4144.352202092694,
                0.4120480400338419,
                -7185.903704401297,
                794.2334747803549,
                665921085.5399495,
                21501.766570755975,
                0.07570530014029198,
                -5012829016.312905,
                5729989055.518624,
                -4824655277.353051,
                27958678.149703063,
                90868501.20354722,
                2975031578.507773,
                0.7621291728058143,
                -3.619147699544599,
                -30.372000171896918,
                -2097.454324739062,
                6023484.042405867,
                0.9559676332803034,
                -0.9217242980854633,
                -7534.72277198079});
  SCPMatrix m2({6,
                6,
                -44228.4723751339,
                -95776.59097362778,
                -7642887.365559748,
                166113.97887758416,
                4.716638703299685,
                -555123.1682177667,
                70.71905576217121,
                -0.08838202908573267,
                903704.957138079,
                -90301.6355162881,
                -551.223194130031,
                -57007077.67166614,
                9526.579963770591,
                -35565359.39568639,
                -855.4290539061295,
                1744.6451010816977,
                0.54279071212788,
                -0.7764468728748694,
                0.30211272717668536,
                -73739189.81683804,
                -8154.764104725164,
                0.5706336145618166,
                789146872.5994653,
                0.9477857830379035,
                0.1720752055660556,
                -469388.3289555333,
                -63038118.02359698,
                -0.270202471417484,
                8584315889.742315,
                77924.40522505612,
                -292228273.6092897,
                2752.510408864344,
                -5626228.357791497,
                88321567.65507483,
                77.66535130184052,
                7293290.774519166});
  SCPMatrix m1_res({6,
                    6,
                    -64071557.457728304,
                    -95386.17390291212,
                    4987290273.674071,
                    166962.84012586164,
                    59234.92089666807,
                    -520146.6006085102,
                    5212.97524483149,
                    5493.438359735269,
                    909956.3671862751,
                    -90310.34065403677,
                    -5912044.7416519215,
                    -57585255.46049152,
                    3187038105.542632,
                    -35565359.84716911,
                    9343674368.118994,
                    -2399.707101010996,
                    0.9548387521617219,
                    -7186.680151274171,
                    794.5355875075315,
                    592181895.7231115,
                    13347.002466030812,
                    0.6463389147021086,
                    -4223682143.71344,
                    5729989056.46641,
                    -4824655277.180976,
                    27489289.82074753,
                    27830383.179950245,
                    2975031578.2375703,
                    8584315890.504444,
                    77920.78607735658,
                    -292228303.98128986,
                    655.0560841252818,
                    397255.68461436965,
                    88321568.61104247,
                    76.74362700375505,
                    7285756.051747185});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 7) {
  SCPMatrix m1({4,
                6,
                -97.67968118674854,
                -1696185325.6653392,
                652654.0556977082,
                -718070806.0481536,
                0.3582018649908846,
                3163280.663149055,
                76.47195545454794,
                -23710.353489472047,
                -7037.509149781002,
                -0.2500279989360168,
                -359961066.3440461,
                53.38603671067415,
                -8817117499.518343,
                -3554.71836888824,
                -409.7161612125021,
                -15551.34020610528,
                -652.109998026018,
                107214442.3807091,
                -0.9625370113631371,
                -0.7164539085952198,
                469537.4752436692,
                -4.618526252036085,
                0.741943597677152,
                7.431931849625735});
  SCPMatrix m2({4,
                6,
                396871474.04111534,
                -63671.84213269073,
                0.5639731936623379,
                -229174.26360540316,
                13262804.09524302,
                -82.32522999516563,
                -0.35082741625028824,
                -0.04403780358090348,
                -846265.7612982715,
                -2060834204.1225214,
                4138947049.6516657,
                14128.788770878942,
                -3478037.0947173755,
                0.2847472548434432,
                -308.2297349678572,
                -70.06814825323622,
                7677.74030936256,
                1196865028.0193727,
                0.8271375114305479,
                -493936488.8717241,
                -228.03461386465062,
                830430282.0247406,
                -247.5186018293849,
                43942226.69996306});
  SCPMatrix m1_res({4,
                    6,
                    396871376.36143416,
                    -1696248997.507472,
                    652654.6196709018,
                    -718299980.311759,
                    13262804.453444885,
                    3163198.33791906,
                    76.12112803829766,
                    -23710.39752727563,
                    -853303.2704480524,
                    -2060834204.3725493,
                    3778985983.3076196,
                    14182.174807589616,
                    -8820595536.61306,
                    -3554.433621633397,
                    -717.9458961803593,
                    -15621.408354358517,
                    7025.630311336542,
                    1304079470.4000819,
                    -0.13539949993258915,
                    -493936489.58817804,
                    469309.4406298045,
                    830430277.4062144,
                    -246.77665823170773,
                    43942234.13189492});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 8) {
  SCPMatrix m1({9,
                5,
                -401.5649815687158,
                -7747383027.475626,
                -4.7518370900166325,
                98326539.85759932,
                66799.27029461476,
                39.58499968541032,
                -1409.6570178655743,
                1426.4589839462283,
                0.7083851950126293,
                55.09592079450339,
                -8.227306682681828,
                17909525.849998154,
                -71.17751138610635,
                510723124.86213034,
                610.4888839033266,
                -24.48144138150864,
                486050854.19723326,
                -42893949.68161681,
                5845.554839781819,
                -0.2337404047957108,
                -5.407246119498433,
                -567.988791613754,
                -95087.48313962542,
                377065583.8422564,
                817123.617504365,
                84798085.70536241,
                5.608894117816986,
                -7.34138173506731,
                8674.149675620582,
                -5553438129.136484,
                -229.29821458813194,
                -46383.885982706626,
                98.644658680675,
                -9.797702643891569,
                1924900.6489126885,
                2.0299915467853213,
                5394403.3877928145,
                34.81134874505061,
                -16.875135468087045,
                0.1576226160394545,
                0.6801558480126072,
                -0.8830205075199572,
                -0.15397968255900196,
                -72421.50461630896,
                -10.866181104126294});
  SCPMatrix m2({9,
                5,
                0.15617560725435575,
                -0.3179115393433444,
                4652.400360116212,
                -6577342.747370533,
                1077.9283951214725,
                -95128458.26829948,
                -6517.004079666839,
                -473930602.01377136,
                658125858.2717882,
                0.48378036401370195,
                474.9087332767481,
                -960086790.3393903,
                -45.646876235459466,
                65884009.943698786,
                -78695.19246486637,
                4011.90654618271,
                3761.2951861228685,
                -16902278.01454336,
                9322.15014746783,
                46801197.04488368,
                8386114893.0398445,
                -4992615948.27502,
                6.669279017349635,
                185284315.68308923,
                2931780710.2352343,
                4.955194129141373,
                0.5451734868934267,
                0.22621006790792764,
                2565017.673001373,
                -859.9543924432551,
                0.6564341227136348,
                99359258.06148313,
                790509559.4967597,
                0.7604164900440099,
                97.01978330329362,
                130797.48762739984,
                -0.23259001539541002,
                177.61887495635676,
                -1800860.7108831564,
                -7.32875808651367,
                977443518.3269861,
                2058201975.2029867,
                975.298170623189,
                1499.095692319148,
                93.24717916729924});
  SCPMatrix m1_res({9,
                    5,
                    -401.40880596146144,
                    -7747383027.793537,
                    4647.648523026195,
                    91749197.11022879,
                    67877.19868973624,
                    -95128418.6832998,
                    -7926.661097532413,
                    -473929175.5547874,
                    658125858.9801735,
                    55.579701158517096,
                    466.68142659406624,
                    -942177264.4893922,
                    -116.82438762156582,
                    576607134.8058292,
                    -78084.70358096305,
                    3987.425104801201,
                    486054615.49241936,
                    -59796227.69616017,
                    15167.70498724965,
                    46801196.81114328,
                    8386114887.632598,
                    -4992616516.263811,
                    -95080.81386060806,
                    562349899.5253457,
                    2932597833.852739,
                    84798090.66055654,
                    6.154067604710413,
                    -7.115171667159383,
                    2573691.822676994,
                    -5553438989.090877,
                    -228.6417804654183,
                    99312874.17550042,
                    790509658.1414183,
                    -9.037286153847559,
                    1924997.6686959919,
                    130799.51761894663,
                    5394403.1552027995,
                    212.43022370140739,
                    -1800877.5860186245,
                    -7.171135470474216,
                    977443519.007142,
                    2058201974.3199663,
                    975.14419094063,
                    -70922.4089239898,
                    82.38099806317294});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SumMatrixOP2, 9) {
  SCPMatrix m1({4,
                7,
                48.66272285900975,
                -0.24683530516612207,
                806.9016958119549,
                0.21596597658154681,
                -775943.5442057404,
                0.242174548478863,
                0.8945651195698326,
                4.194147561870114,
                0.7723736939323486,
                -277659226.30900383,
                54.76477215629355,
                -873222.2737514051,
                348436.70882324653,
                0.4131159332285167,
                6332186.061770944,
                -87496.66873825039,
                -69377.17881413344,
                2698.8561522028167,
                534674.1523996355,
                -0.9599076118835833,
                171387504.38455984,
                44.369208256564875,
                -4847.05078590321,
                -4286596474.969548,
                252223.99679398266,
                -5691620911.162004,
                71173.59475302618,
                -361790.4829095053});
  SCPMatrix m2({4,
                7,
                8.643584036332763,
                -4893.60547440188,
                0.4628356109302564,
                -9170582764.921524,
                8.288145263346921,
                39836238.737904206,
                -92195.59213196096,
                -96425404.38798328,
                927905.573602831,
                -28849.868745850727,
                -7380867118.703084,
                870.0996469889569,
                -667.2556580023056,
                914284360.4051721,
                -3656202.455905434,
                -403354439.7200848,
                -2248.3271414843643,
                -997278936.8649379,
                -0.30617679032664935,
                1783133330.159098,
                9963.587834162594,
                -7752865587.054603,
                38818.24521439374,
                0.12054509475223707,
                -158.75916688781143,
                0.48176059305044805,
                67.80477619540288,
                -91.03022173791217});
  SCPMatrix m1_res({4,
                    7,
                    57.30630689534251,
                    -4893.8523097070465,
                    807.3645314228852,
                    -9170582764.705559,
                    -775935.2560604771,
                    39836238.98007876,
                    -92194.6975668414,
                    -96425400.19383572,
                    927906.3459765249,
                    -277688076.1777497,
                    -7380867063.938312,
                    -872352.1741044162,
                    347769.45316524425,
                    914284360.8182881,
                    2675983.6058655097,
                    -403441936.38882303,
                    -71625.5059556178,
                    -997276238.0087857,
                    534673.8462228453,
                    1783133329.1991904,
                    171397467.972394,
                    -7752865542.685394,
                    33971.19442849053,
                    -4286596474.8490033,
                    252065.23762709484,
                    -5691620910.6802435,
                    71241.39952922158,
                    -361881.51313124323});

  m1 += m2;
  EXPECT_TRUE(m1 == m1_res);
}
