#include "scp_matrix_oop_tests.h"

TEST(SubMatrix, 0) {
  SCPMatrix m1({5,
                6,
                1186418265.3531563,
                2442541063.3772526,
                -887558048.0764391,
                -4073157.698685466,
                -0.42391887444551,
                2690889.6419152464,
                1771310832.2225778,
                -0.0824550284090545,
                -6319627804.011879,
                -1005.9816426481316,
                -26925.95254910819,
                7935023252.400339,
                332465293.3787757,
                83803860.04092756,
                -57168.99858080495,
                0.04035378214080765,
                -620983.6809098839,
                721020.0965441011,
                40968.80962414506,
                77.83681618373328,
                -9818175613.11239,
                96937955.37191513,
                -9.123901103502877,
                2187845.031146132,
                -431.6857850949444,
                94327.77416689288,
                2573486646.266898,
                50924.15634804284,
                -603.2212681461739,
                4493.908175415157});
  SCPMatrix m2({5,
                6,
                0.3793035073123008,
                0.8787041946440153,
                -2414.043522089915,
                -120980860.103853,
                -707629.3063469299,
                -2940.2749979462083,
                0.6708778632296661,
                0.30013378094069865,
                -2506481.2049038853,
                -564727533.1617877,
                -0.6884547467400975,
                -0.6193425776403523,
                -154.51705654607073,
                0.5601049847960273,
                9780789854.304117,
                0.6162608978365636,
                8710385947.758657,
                945514.0207539501,
                4539.798004797677,
                -45.71877330133176,
                -1.3181263874962301,
                -1781016294.6775088,
                6313483221.914904,
                -480008532.7583611,
                18643021.89610605,
                0.9610350343067466,
                -9.231259140130497,
                26.19051937241973,
                -0.7717672345753753,
                8653112330.625153});
  SCPMatrix m1_res({5,
                    6,
                    1186418264.9738529,
                    2442541062.4985485,
                    -887555634.032917,
                    116907702.40516753,
                    707628.8824280554,
                    2693829.9169131927,
                    1771310831.5516999,
                    -0.38258880934975315,
                    -6317121322.806975,
                    564726527.1801451,
                    -26925.26409436145,
                    7935023253.019682,
                    332465447.89583224,
                    83803859.48082258,
                    -9780847023.302698,
                    -0.5759071156957559,
                    -8711006931.439568,
                    -224493.92420984898,
                    36429.01161934739,
                    123.55558948506504,
                    -9818175611.794264,
                    1877954250.049424,
                    -6313483231.038805,
                    482196377.7895072,
                    -18643453.581891146,
                    94326.81313185857,
                    2573486655.4981575,
                    50897.965828670414,
                    -602.4495009115985,
                    -8653107836.716978});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 1) {
  SCPMatrix m1({4, 4, 0.7377235853333906, 926855766.1159714, 63238473.00124812,
                -9704390.016033398, 469.74673163876855, 175275000.87614623,
                -470.47108042066577, -21.021402092111117, 4271023.7011766825,
                -5.90055436967699, 8630.937521293386, 400.00348244814353,
                49848534.302987, -6771808.043667679, -84589357.6559019,
                0.8092604699880203});
  SCPMatrix m2({4, 4, -6434480088.156957, 51309.60774172201, 782190037.1280999,
                456744024.88508624, -0.08174988982925957, -2531.4130259095823,
                637619608.3189977, 7741357530.549413, -3352779530.625407,
                6671733.9105072105, 7.273797188529479, -0.054770479997492405,
                -0.9846829416982165, -93014745.5443288, -76078096.9205234,
                4139286.5688904035});
  SCPMatrix m1_res({4, 4, 6434480088.89468, 926804456.5082297,
                    -718951564.1268518, -466448414.90111965, 469.8284815285978,
                    175277532.28917214, -637620078.7900782, -7741357551.570815,
                    3357050554.326584, -6671739.811061581, 8623.663724104857,
                    400.05825292814103, 49848535.28766994, 86242937.50066112,
                    -8511260.735378489, -4139285.7596299336});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 2) {
  SCPMatrix m1({6,
                6,
                161999.34141996587,
                2.6564719670787653,
                167375.06931704062,
                63130.481473649445,
                -46.63872315494715,
                0.19722526435465415,
                -19210373.54146753,
                64643753.643660605,
                5.188166614430213,
                358.89626129897147,
                -8.565050520402695,
                118002908.23316805,
                -0.7408258863704862,
                -7666.034152453712,
                -405003.08522940765,
                -9446.03949347676,
                186.64049454118003,
                6174497368.080479,
                0.5511881791887275,
                -0.13581323153675295,
                0.7511551960194844,
                -35650927.95203672,
                -7335213.000264536,
                8878692155.677528,
                -25185300.35140889,
                -0.11220737583807372,
                950046181.952337,
                -9764927.991365742,
                0.9382982982212146,
                -625899759.3013213,
                5499.544307465122,
                863856.1799809227,
                28566.672651919034,
                0.3168455578983267,
                -745.425023371278,
                174583983.9254435});
  SCPMatrix m2({6,
                6,
                9.72375400439154,
                6.0719790234720055,
                -7778302042.431203,
                -55338083.173547745,
                82938.22746825758,
                38460.09366556815,
                -70706.47211194104,
                -228.50441968677958,
                -43483181.825311646,
                -14665.109951517163,
                -520.598583413024,
                814.2496438677867,
                393305210.57143754,
                2.8574083642390544,
                -25874.135344766513,
                -782003201.293697,
                -7990218.377549418,
                578106080.2591622,
                -21729702.437022768,
                -3567.577980291551,
                69.19202277564918,
                725331.7983535893,
                4396142000.88427,
                740590.3279671302,
                -3047484055.9921813,
                -38.25969727581449,
                -2837.1553650122405,
                1817419.2571578796,
                -1924937.7515373002,
                12.476210396094334,
                54.69609111581774,
                -1837571.8940302888,
                -0.8090139502038987,
                -8512874.527409673,
                0.040102390210736694,
                -0.08711027267256743});
  SCPMatrix m1_res({6,
                    6,
                    161989.61766596147,
                    -3.41550705639324,
                    7778469417.50052,
                    55401213.65502139,
                    -82984.86619141253,
                    -38459.8964403038,
                    -19139667.06935559,
                    64643982.14808029,
                    43483187.01347826,
                    15024.006212816133,
                    512.0335328926213,
                    118002093.98352419,
                    -393305211.3122634,
                    -7668.89156081795,
                    -379128.94988464116,
                    781993755.2542036,
                    7990405.0180439595,
                    5596391287.821317,
                    21729702.988210946,
                    3567.442167060014,
                    -68.4408675796297,
                    -36376259.75039031,
                    -4403477213.884534,
                    8877951565.349562,
                    3022298755.6407723,
                    38.147489899976414,
                    950049019.107702,
                    -11582347.24852362,
                    1924938.6898355985,
                    -625899771.7775316,
                    5444.8482163493045,
                    2701428.0740112113,
                    28567.48166586924,
                    8512874.844255231,
                    -745.4651257614888,
                    174583984.01255378});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 3) {
  SCPMatrix m1({1, 1, 9027.26148921451});
  SCPMatrix m2({1, 1, -22600.35955967138});
  SCPMatrix m1_res({1, 1, 31627.62104888589});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 4) {
  SCPMatrix m1({5, 2, 16383.156881853289, 964968.0880741832,
                0.29155037930624095, 8829056.062212536, 545456.3135263161,
                1452222780.9605393, -82470618.49370135, 87.73016362647573,
                35.02548185717805, 65815.23498918852});
  SCPMatrix m2({5, 2, -0.5502057727352931, -5375.164699610609,
                -803437.7163170364, 44905289.691454776, -73130045.65254112,
                -23332.6818503905, 2564949312.8104715, 27379321.237580977,
                0.7947600154725049, -9435.96748515569});
  SCPMatrix m1_res({5, 2, 16383.707087626024, 970343.2527737938,
                    803438.0078674158, -36076233.62924224, 73675501.96606743,
                    1452246113.6423898, -2647419931.304173, -27379233.50741735,
                    34.230721841705545, 75251.20247434422});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 5) {
  SCPMatrix m1({6,
                5,
                -0.8355093589462316,
                6491659.44114058,
                -5298.101642721504,
                2124.368258171696,
                -685441338.9182687,
                -0.16507886474912004,
                244.3365292967381,
                88745.22224117076,
                -8390605.0337827,
                5116348.052037462,
                -57366070.4166441,
                40341.35820920558,
                9.863864496212912,
                1.4019685062475962,
                -9.504926789901758,
                5767266.910515229,
                -5344935.773892846,
                8229254.263047208,
                0.819936136460342,
                -72.80603672928302,
                0.11617952943799925,
                13.953429522027427,
                0.8364579650239299,
                -2418766.9127662512,
                -3.650155682292967,
                0.45271856227952356,
                90.83694874685145,
                3.035324171113045,
                -69940.16554587874,
                -4.770922166070442});
  SCPMatrix m2({6,
                5,
                -0.6900269528484182,
                5.009872587430186,
                0.015223323205014405,
                -9.03685063098014,
                511.0437215158414,
                -29390296.663718373,
                6221292.4258417515,
                0.9443869826796709,
                -80038.72815800873,
                49724.61948121684,
                545.7352309164435,
                -0.8929616208728588,
                28.933000682387423,
                0.6924849385467495,
                -87.29714831126711,
                6433.3606850288725,
                -0.2588557301186708,
                -82.59077547296745,
                -0.44108175943875627,
                -27888800.17323462,
                -22720.268607570604,
                2.818718131400532,
                -6.700417248287086,
                0.6844306262281379,
                94369.49584052958,
                -857.4872339329179,
                9818843.350085348,
                9.146826534167124,
                -180576.7516314597,
                -17302657.475152172});
  SCPMatrix m1_res({6,
                    5,
                    -0.14548240609781338,
                    6491654.431267993,
                    -5298.116866044708,
                    2133.4051088026763,
                    -685441849.9619902,
                    29390296.49863951,
                    -6221048.089312455,
                    88744.27785418808,
                    -8310566.305624692,
                    5066623.432556245,
                    -57366616.15187501,
                    40342.25117082645,
                    -19.06913618617451,
                    0.7094835677008466,
                    77.79222152136535,
                    5760833.5498302,
                    -5344935.515037116,
                    8229336.853822681,
                    1.2610178958990983,
                    27888727.36719789,
                    22720.384787100043,
                    11.134711390626896,
                    7.536875213311015,
                    -2418767.5971968775,
                    -94373.14599621187,
                    857.9399524951974,
                    -9818752.513136601,
                    -6.111502363054079,
                    110636.58608558094,
                    17302652.704230007});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 6) {
  SCPMatrix m1({2, 2, -7.4841694488077435, 300799.244639009,
                -0.27616617665772825, 0.6720692906781218});
  SCPMatrix m2({2, 2, -6712038288.32716, 408.2556139926829, 0.9115965151758949,
                -5759750325.136459});
  SCPMatrix m1_res({2, 2, 6712038280.842991, 300390.9890250163,
                    -1.187762691833623, 5759750325.808529});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 7) {
  SCPMatrix m1({7,
                7,
                0.0521925196351718,
                -0.5599220372321008,
                0.3135858800643757,
                82.67667078380828,
                -0.10840234821699601,
                -7660067.575431955,
                783472122.0881695,
                4748.067094154307,
                -0.18848428901814862,
                -86802.70886562981,
                -0.06946683187691882,
                -493439.35414474347,
                91.0422043926857,
                772412221.7732872,
                -3949049919.188312,
                59.6643715426482,
                317068.8520361621,
                -0.8010407504574526,
                -480420.4800895917,
                0.24619373925005916,
                0.30306187454191635,
                751.167219678963,
                1213732.641362706,
                -0.8600989096261997,
                0.002617875779644785,
                9.64984246234588,
                641609786.287703,
                9.857458346299463,
                -26386312.68566224,
                0.7307227424818428,
                41.66275029120287,
                -9465770.698920002,
                112.12005990391883,
                66.46918809592603,
                -0.1372238140335872,
                45575619.684201874,
                -6.440924447973842,
                -418.40235546211966,
                -0.5370014031548808,
                86101071.51857841,
                49.41691321458123,
                510485.2449904096,
                -8391.16775759755,
                -9.032980030868162,
                13.412197257754277,
                0.5917064458069986,
                -0.5107166090602192,
                -312124.0969284056,
                -8762878.80902852});
  SCPMatrix m2({1, 1, 1581439612.227271});

  EXPECT_THROW(m1.SubMatrix(m2), std::invalid_argument);
}

TEST(SubMatrix, 8) {
  SCPMatrix m1({7,
                6,
                -6177082.158871972,
                418234083.91581064,
                -97760873.77871723,
                -0.15751667196047392,
                -413.1738806849906,
                0.14028555628829464,
                -39152677.21813378,
                -8.222245451454103,
                -4.246137679093827,
                2434.990934375236,
                8.56532304118198,
                -0.994138823860162,
                -0.6194880008691662,
                -62930667.84522926,
                91014507.05906896,
                44.572232722616555,
                4164.425576392798,
                -94847330.71305469,
                0.19454593790697583,
                8.83069339872085,
                302284577.3992343,
                8.168806769360623,
                -9948590722.70722,
                -496208.9125153436,
                -61880027.95003506,
                -171090.18435084334,
                5013.7499951495865,
                -38797106.867545106,
                -0.5220406527007287,
                -0.19317268754270556,
                4555965.410344829,
                -3801902235.64462,
                -8.30829414881679,
                3.5343121059822513,
                935503.7705389011,
                1.6885825627503759,
                -667965524.4169855,
                0.4373910447351026,
                -11011554.449099414,
                -772497764.5765233,
                -27083852.613356095,
                0.5575569055115603});
  SCPMatrix m2({7,
                6,
                -9492965.982231071,
                -634380.5266770459,
                18.931570573270918,
                -12093.81080146542,
                28.06492364445159,
                23.12993795242494,
                -4.141045587553584,
                2063.7966877964254,
                -37627.96102177549,
                23.11360089458301,
                -1596088.7636369457,
                -344.0052955695193,
                -9264.124981264455,
                905.8358122971446,
                18425.65498951796,
                -695594449.6904954,
                -0.2820380935580571,
                -279003.83628683025,
                80359142.88837531,
                -384956.1440509165,
                2799.6206281574487,
                3278868.423934416,
                508980.91939652676,
                -147924000.55881193,
                -9937883285.787857,
                -4.430748305404264,
                -95640247.2776331,
                637.1882996860894,
                630452706.7799822,
                87829.14821373514,
                -705.3196910196925,
                -2.202674383226176,
                -7.757151568757479,
                597070.8360155076,
                -8179586824.964858,
                0.9344227456934482,
                -111831477.5144288,
                8364.822608086533,
                -1.1446608805305192,
                59354105.32188765,
                -5545.643819719911,
                -3571.9335319960164});
  SCPMatrix m1_res({7,
                    6,
                    3315883.823359099,
                    418868464.4424877,
                    -97760892.71028781,
                    12093.65328479346,
                    -441.2388043294422,
                    -22.989652396136645,
                    -39152673.07708819,
                    -2072.0189332478794,
                    37623.71488409639,
                    2411.877333480653,
                    1596097.328959987,
                    343.01115674565915,
                    9263.505493263585,
                    -62931573.68104156,
                    90996081.40407945,
                    695594494.2627281,
                    4164.707614486356,
                    -94568326.87676786,
                    -80359142.69382937,
                    384964.9747443152,
                    302281777.7786061,
                    -3278860.2551276465,
                    -9949099703.626617,
                    147427791.6462966,
                    9876003257.837822,
                    -171085.75360253794,
                    95645261.02762824,
                    -38797744.05584479,
                    -630452707.3020228,
                    -87829.34138642269,
                    4556670.730035849,
                    -3801902233.4419456,
                    -0.5511425800593113,
                    -597067.3017034016,
                    8180522328.735397,
                    0.7541598170569277,
                    -556134046.9025567,
                    -8364.385217041798,
                    -11011553.304438533,
                    -831851869.8984109,
                    -27078306.969536375,
                    3572.491088901528});

  m1.SubMatrix(m2);
  EXPECT_TRUE(m1 == m1_res);
}

TEST(SubMatrix, 9) {
  SCPMatrix m1({5,
                5,
                202868.1205450744,
                0.8186354698060337,
                -0.10753051475788233,
                -287.472605266319,
                492073127.7829641,
                -765.3821467488506,
                -3588267370.9228573,
                92.89444278962007,
                -0.5765512561570199,
                -4551757799.15164,
                750.6606653193522,
                -925.4255023402756,
                -6311290859.770866,
                52113.46302111691,
                96540987.58531916,
                0.4524676834360801,
                300.33610194739646,
                -8766.364696345572,
                0.716875267805881,
                -913902105.7650982,
                4825514221.135505,
                -76329.29638718466,
                -46289441.56330182,
                -0.10822486423171662,
                -168.02114575117844});
  SCPMatrix m2({6,
                8,
                2101.8200028719357,
                5807629.893561057,
                1248.2509400965791,
                97658018.31420995,
                0.9510199686296709,
                0.3808499404416189,
                -19638671.926455975,
                0.5557349806809264,
                0.41840900534084036,
                -7382.647164571309,
                6115382.67349158,
                11529110.68151663,
                7017373483.3571,
                2488.6261626044293,
                35156133.89865169,
                0.08698793216372114,
                164390.0859504218,
                586567.7195719066,
                0.49164870817220985,
                -5036188.324321415,
                -1630.0268699157573,
                234077164.51326054,
                0.6921782404765947,
                -251551341.7809394,
                -377200612.9633906,
                2324504.475991918,
                48160462.810752966,
                -506747.7922469509,
                18630.185052693672,
                -2609459426.873887,
                -39.67256094157696,
                1767993477.4111605,
                -2956255.3064664933,
                0.5804706887993594,
                181.55185064766243,
                68829702.2536592,
                0.8584073978225598,
                803.3046679605271,
                -749.5996420247668,
                0.8581640885649325,
                2418823.303861197,
                5943.407980237159,
                68927537.66628546,
                -17547.666447382337,
                -94606031.99047591,
                62.910335061876246,
                0.19517656619203405,
                657413.3259275443});

  EXPECT_THROW(m1.SubMatrix(m2), std::invalid_argument);
}
